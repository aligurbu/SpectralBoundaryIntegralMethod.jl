using SpectralBoundaryIntegralMethod: associatedLegendreFun

@testset "associatedLegendreFun" begin
    Pnm = [ 0.707106781186547  0                  0;
            0.612372435695795  0.75               0;
           -0.197642353760523  0.838525491562421  0.726184377413891]
    @test associatedLegendreFun(2, pi/3) ≈ Pnm

    @test associatedLegendreFun(0, π) ≈ [0.707106781186547]
    @test associatedLegendreFun(1, π) ≈ [ 0.707106781186547 0;
                                         -1.224744871391589 0]

    θ = [pi/2; pi/3; pi/4; pi/8]
    n = 3
    Pnm = [Matrix{Float64}(undef, n+1,n+1) for _ in 0:n]

    Pnm[1] = [0.707106781186547     0.000000000000000     -0.790569415042095    -0.000000000000000
              0.707106781186547     0.612372435695795     -0.197642353760523    -0.818487553356800
              0.707106781186547     0.866025403784439      0.395284707521048    -0.330718913883074
              0.707106781186547     1.131516719226857      1.233810199083468     1.095617093090909]
    Pnm[2] = [0     0.866025403784439     0.000000000000000     -0.810092587300982;
              0     0.750000000000000     0.838525491562421      0.175390190005029;
              0     0.612372435695794     0.968245836551854      0.859232942804220;
              0     0.331413574035592     0.684653196881458      1.013037204018577]
    Pnm[3] = [0     0     0.968245836551854     0.000000000000000;
              0     0     0.726184377413891     0.960651634308713;
              0     0     0.484122918275927     0.905711046636840;
              0     0     0.141796319835198     0.346600612057964]
    Pnm[4] = [0     0     0     1.045825033167594;
              0     0     0     0.679283284977630;
              0     0     0     0.369754986443726;
              0     0     0     0.058610849326562]
    #=
    Pnm[1] = [P00[pi/2]     P10[pi/2]     P20[pi/2]     P30[pi/2];
              P00[pi/3]     P10[pi/3]     P20[pi/3]     P30[pi/3];
              P00[pi/4]     P10[pi/4]     P20[pi/4]     P30[pi/4];
              P00[pi/8]     P10[pi/8]     P20[pi/8]     P30[pi/8]]
    Pnm[2] = [0     P11[pi/2]     P21[pi/2]     P31[pi/2];
              0     P11[pi/3]     P21[pi/3]     P31[pi/3];
              0     P11[pi/4]     P21[pi/4]     P31[pi/4];
              0     P11[pi/8]     P21[pi/8]     P31[pi/8]]
    Pnm[3] = [0     0     P22[pi/2]     P32[pi/2];
              0     0     P22[pi/3]     P32[pi/3];
              0     0     P22[pi/4]     P32[pi/4];
              0     0     P22[pi/8]     P32[pi/8]]
    Pnm[4] = [0     0     0     P32[pi/2];
              0     0     0     P32[pi/3];
              0     0     0     P32[pi/4];
              0     0     0     P32[pi/8]]
    =#
    @test associatedLegendreFun(n,θ) ≈ Pnm
end